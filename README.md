# æ™ºèƒ½æ–‡æœ¬åˆ†æç³»çµ± (Claude APIé©…å‹•)

ä¸€å€‹åŸºæ–¼Claude APIçš„æ™ºèƒ½ä¸­æ–‡æ–‡æœ¬åˆ†æç³»çµ±ï¼Œå°ˆé–€ç”¨æ–¼äººç‰©è­˜åˆ¥å’Œé—œä¿‚åˆ†æã€‚ç³»çµ±æ¡ç”¨Flaskå¾Œç«¯å’Œç¾ä»£åŒ–å‰ç«¯ç•Œé¢ï¼Œæä¾›é«˜ç²¾åº¦çš„æ–‡æœ¬è™•ç†èƒ½åŠ›ã€‚

## ğŸš€ ç³»çµ±ç‰¹è‰²

- **ğŸ¤– Claude APIé›†æˆ**ï¼šä½¿ç”¨Claude 3.5 Sonneté€²è¡Œé«˜ç²¾åº¦æ–‡æœ¬åˆ†æ
- **ğŸ‘¥ äººç‰©è­˜åˆ¥**ï¼šæº–ç¢ºè­˜åˆ¥æ–‡æœ¬ä¸­çš„äººç‰©è§’è‰²ï¼ˆæº–ç¢ºç‡>90%ï¼‰
- **ğŸ”— é—œä¿‚åˆ†æ**ï¼šè‡ªå‹•åˆ†æäººç‰©é–“çš„é—œä¿‚ç¶²çµ¡
- **ğŸ“Š è¦–è¦ºåŒ–å±•ç¤º**ï¼šäººç‰©é—œä¿‚åœ–å’Œè©³ç´°æ•¸æ“šå ±å‘Š
- **âš¡ æ™ºèƒ½é™ç´š**ï¼šAPIæ•…éšœæ™‚è‡ªå‹•åˆ‡æ›åˆ°æ­£å‰‡è¡¨é”å¼æå–
- **ğŸ”’ å®‰å…¨é…ç½®**ï¼šç’°å¢ƒè®Šé‡ç®¡ç†APIå¯†é‘°
- **ğŸ“± éŸ¿æ‡‰å¼è¨­è¨ˆ**ï¼šé©é…æ¡Œé¢å’Œç§»å‹•è¨­å‚™

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
analysis/
â”œâ”€â”€ backend/                 # Claude APIé›†æˆå¾Œç«¯
â”‚   â”œâ”€â”€ app.py              # ä¸»æ‡‰ç”¨ç¨‹å¼ (Claude API)
â”‚   â”œâ”€â”€ requirements.txt    # ç°¡åŒ–ä¾è³´ (åƒ…4å€‹å¥—ä»¶)
â”‚   â”œâ”€â”€ .env.example       # ç’°å¢ƒè®Šé‡ç¯„æœ¬
â”‚   â””â”€â”€ .gitignore         # å®‰å…¨é…ç½®
â”œâ”€â”€ backend_nlp_backup/     # åŸNLPç³»çµ±å‚™ä»½
â”‚   â”œâ”€â”€ app.py             # åŸå§‹BERT+CRFç³»çµ±
â”‚   â”œâ”€â”€ nlp_models/        # è¤‡é›œNLPç®¡é“
â”‚   â””â”€â”€ requirements.txt   # å®Œæ•´NLPä¾è³´
â”œâ”€â”€ backend reference/      # æ¶æ§‹åƒè€ƒ
â”‚   â”œâ”€â”€ prompt_core/       # é€²éšæç¤ºå·¥ç¨‹
â”‚   â”œâ”€â”€ api/               # APIè—åœ–è¨­è¨ˆ
â”‚   â””â”€â”€ tests/             # æ¸¬è©¦æ¡†æ¶
â”œâ”€â”€ frontend/              # ç¾ä»£åŒ–å‰ç«¯ç•Œé¢
â”‚   â”œâ”€â”€ static/
â”‚   â”‚   â”œâ”€â”€ css/style.css  # è—ç´«è‰²æ¼¸å±¤è¨­è¨ˆ
â”‚   â”‚   â””â”€â”€ js/main.js     # äººç‰©é—œä¿‚å¯è¦–åŒ–
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ index.html     # ä¸»åˆ†æç•Œé¢
â””â”€â”€ å·¥ä½œå ±å‘Š_2025-09-18.md  # å®Œæ•´æŠ€è¡“å ±å‘Š
```

## ğŸ› ï¸ å¿«é€Ÿé–‹å§‹

### 1. ç’°å¢ƒæº–å‚™
```bash
# å…‹éš†å°ˆæ¡ˆ
git clone https://github.com/ian930818-ctrl/analysis.git
cd analysis

# è¨­ç½®è™›æ“¬ç’°å¢ƒ
python -m venv venv

# å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux  
source venv/bin/activate

# å®‰è£ä¾è³´
pip install -r backend/requirements.txt
```

### 2. é…ç½®Claude API
```bash
# è¤‡è£½ç’°å¢ƒè®Šé‡ç¯„æœ¬
cp backend/.env.example backend/.env

# ç·¨è¼¯.envæ–‡ä»¶ï¼Œè¨­ç½®æ‚¨çš„Claude APIå¯†é‘°
# CLAUDE_API_KEY=your_claude_api_key_here
```

### 3. å•Ÿå‹•æœå‹™
```bash
# è¨­ç½®ç’°å¢ƒè®Šé‡ (æˆ–åœ¨.envæ–‡ä»¶ä¸­é…ç½®)
export CLAUDE_API_KEY="your_claude_api_key_here"

# å•Ÿå‹•å¾Œç«¯æœå‹™
cd backend
python app.py
```

### 4. è¨ªå•ç³»çµ±
- ä¸»æ‡‰ç”¨ï¼šhttp://localhost:5001
- APIç‹€æ…‹ï¼šhttp://localhost:5001/api/llm-status
- å¥åº·æª¢æŸ¥ï¼šhttp://localhost:5001/api/hello

## ğŸ“Š ä½¿ç”¨æ–¹æ³•

### æ–‡æœ¬åˆ†ææµç¨‹
1. **è¼¸å…¥æ–‡æœ¬**ï¼šåœ¨å‰ç«¯ç•Œé¢è²¼å…¥è¦åˆ†æçš„ä¸­æ–‡æ–‡æœ¬
2. **äººç‰©è­˜åˆ¥**ï¼šç³»çµ±è‡ªå‹•è­˜åˆ¥æ–‡æœ¬ä¸­çš„äººç‰©è§’è‰²
3. **é—œä¿‚åˆ†æ**ï¼šåˆ†æäººç‰©é–“çš„äº’å‹•é—œä¿‚
4. **çµæœè¦–è¦ºåŒ–**ï¼šç”Ÿæˆäººç‰©é—œä¿‚åœ–å’Œè©³ç´°å ±å‘Š
5. **æ•¸æ“šå°å‡º**ï¼šæ”¯æŒCSVæ ¼å¼å°å‡ºåˆ†æçµæœ

### APIç«¯é»èªªæ˜
```bash
# ä¸»è¦åˆ†æAPI
POST /api/analyze-text
{
  "text": "è¦åˆ†æçš„æ–‡æœ¬å…§å®¹",
  "manual_corrections": {}  # å¯é¸çš„æ‰‹å‹•ä¿®æ­£
}

# ç³»çµ±ç‹€æ…‹æª¢æŸ¥
GET /api/llm-status

# äººç‰©ä¿®æ­£
POST /api/correct-characters
```

## âš¡ æ€§èƒ½å„ªå‹¢

| æŒ‡æ¨™ | åŸNLPç³»çµ± | Claude APIç³»çµ± | æ”¹å–„å¹…åº¦ |
|------|-----------|----------------|----------|
| **äººç‰©è­˜åˆ¥æº–ç¢ºç‡** | ~70% | >90% | +20% |
| **ç³»çµ±ä¾è³´æ•¸é‡** | 14å€‹ | 4å€‹ | -71% |
| **å•Ÿå‹•æ™‚é–“** | ~30ç§’ | ~3ç§’ | -90% |
| **å…§å­˜ä½¿ç”¨** | ~2GB | ~50MB | -95% |
| **å¹³å‡éŸ¿æ‡‰æ™‚é–“** | 5-10ç§’ | 1-3ç§’ | -60% |

## ğŸ”§ æŠ€è¡“æ¶æ§‹

### å¾Œç«¯æŠ€è¡“æ£§
- **Flask**: Webæ¡†æ¶
- **Claude API**: Anthropicçš„Claude 3.5 Sonnetæ¨¡å‹
- **Anthropic SDK**: å®˜æ–¹Python SDK
- **CORS**: è·¨åŸŸè³‡æºå…±äº«

### å‰ç«¯æŠ€è¡“æ£§  
- **åŸç”ŸJavaScript**: å‹•æ…‹äº¤äº’
- **D3.js**: é—œä¿‚åœ–è¦–è¦ºåŒ–
- **CSS Grid/Flexbox**: éŸ¿æ‡‰å¼ä½ˆå±€
- **ç¾ä»£åŒ–UI**: è—ç´«è‰²æ¼¸å±¤è¨­è¨ˆ

### æ™ºèƒ½é™ç´šæ©Ÿåˆ¶
```python
# Claude APIå¯ç”¨æ™‚
characters = extract_characters_with_claude(text)

# APIæ•…éšœæ™‚è‡ªå‹•é™ç´š
if not claude_client:
    characters = simple_extract_characters(text)  # æ­£å‰‡è¡¨é”å¼
```

## ğŸš§ é–‹ç™¼æŒ‡å¼•

### æ–°å¢åˆ†æåŠŸèƒ½
```python
@app.route('/api/new-analysis', methods=['POST'])
def new_analysis():
    data = request.get_json()
    result = analyze_with_claude(data['text'])
    return jsonify(result)
```

### è‡ªå®šç¾©æç¤ºå·¥ç¨‹
ç·¨è¼¯ `extract_characters_with_claude()` å‡½æ•¸ä¸­çš„promptï¼š
```python
prompt = f"""æ‚¨çš„è‡ªå®šç¾©åˆ†ææç¤º
æ–‡æœ¬ï¼š{text}"""
```

### æ“´å±•é™ç´šæ©Ÿåˆ¶
åœ¨ `simple_extract_characters()` ä¸­æ·»åŠ æ–°çš„æ­£å‰‡æ¨¡å¼ï¼š
```python
patterns = [
    r'([ä¸€-é¾¥]{2,4})èªª',
    r'æ‚¨çš„æ–°æ¨¡å¼',
]
```

## ğŸ“‹ ç³»çµ±ç›£æ§

### å¥åº·æª¢æŸ¥
```bash
curl http://localhost:5001/api/llm-status
```

### æ€§èƒ½æŒ‡æ¨™
- APIéŸ¿æ‡‰æ™‚é–“
- äººç‰©è­˜åˆ¥æº–ç¢ºç‡  
- ç³»çµ±è³‡æºä½¿ç”¨ç‡
- Claude APIèª¿ç”¨æ¬¡æ•¸

## ğŸ”’ å®‰å…¨è€ƒé‡

- âœ… **APIå¯†é‘°ä¿è­·**ï¼šä½¿ç”¨ç’°å¢ƒè®Šé‡ï¼Œä¸åœ¨ä»£ç¢¼ä¸­ç¡¬ç·¨ç¢¼
- âœ… **è¼¸å…¥é©—è­‰**ï¼šé˜²æ­¢æƒ¡æ„æ–‡æœ¬æ³¨å…¥
- âœ… **éŒ¯èª¤è™•ç†**ï¼šé¿å…æ•æ„Ÿä¿¡æ¯æ´©éœ²
- âœ… **CORSé…ç½®**ï¼šæ§åˆ¶è·¨åŸŸè«‹æ±‚
- âœ… **Gitå®‰å…¨**ï¼šè‡ªå‹•å¿½ç•¥æ•æ„Ÿæ–‡ä»¶

## ğŸ“ˆ æœªä¾†ç™¼å±•è¦åŠƒ

### çŸ­æœŸç›®æ¨™ (1-2é€±)
- [ ] æ‰¹é‡æ–‡æœ¬åˆ†æ
- [ ] çµæœç·©å­˜æ©Ÿåˆ¶
- [ ] APIç”¨é‡ç›£æ§
- [ ] å¤šç¨®å°å‡ºæ ¼å¼

### ä¸­æœŸç›®æ¨™ (1å€‹æœˆ)
- [ ] å¤šæ¨¡å‹å°æ¯”åˆ†æ
- [ ] è‡ªå®šç¾©æç¤ºç¯„æœ¬
- [ ] ç”¨æˆ¶åå¥½è¨˜æ†¶
- [ ] é«˜ç´šé—œä¿‚åˆ†æ

### é•·æœŸç›®æ¨™ (3å€‹æœˆ)
- [ ] å¢é‡å­¸ç¿’èƒ½åŠ›
- [ ] å¤šèªè¨€æ”¯æŒ
- [ ] å¯¦æ™‚å”ä½œåˆ†æ
- [ ] ä¼æ¥­ç´šéƒ¨ç½²

## ğŸ“– æŠ€è¡“æ–‡æª”

è©³ç´°æŠ€è¡“å¯¦ç¾è«‹åƒè€ƒï¼š
- ğŸ“„ [å·¥ä½œå ±å‘Š_2025-09-18.md](./å·¥ä½œå ±å‘Š_2025-09-18.md) - å®Œæ•´é‡æ§‹å ±å‘Š
- ğŸ“ [backend reference/](./backend%20reference/) - æ¶æ§‹åƒè€ƒå¯¦ç¾
- ğŸ“ [backend_nlp_backup/](./backend_nlp_backup/) - åŸNLPç³»çµ±å‚™ä»½

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤è®Šæ›´ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. é–‹å•Ÿ Pull Request

## ğŸ“„ æˆæ¬Šå”è­°

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šå”è­° - è©³è¦‹ LICENSE æ–‡ä»¶

---

**ğŸ¤– ç”± Claude Code å”åŠ©é–‹ç™¼** | **âš¡ Claude API é©…å‹•** | **ğŸ¯ é«˜ç²¾åº¦ä¸­æ–‡æ–‡æœ¬åˆ†æ**